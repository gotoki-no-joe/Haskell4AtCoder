# nCk mod P とモジュロの逆元

[https://algo-logic.info/combination/](https://algo-logic.info/combination/)

同じような話は「あのどこ」でも扱っているが、より実践的な側面からも、理論的な側面についても書かれていてありがたい。

$${}_nC_k = \frac{n!}{k! (n-k)!}$$は除算を含むが、これを$$\mod P$$ において除算なしで計算できるようにするには逆元が必要。その求め方。

* 拡張ユークリッドの互除法
* フェルマーの小定理と繰り返し2乗法

（どちらかはPが素数でなくても使える場合がある、みたいな話があったような。）

$${}_nC_k \mod P$$を効率的に求める方法

* Pが素数のとき
  * $$n \leq 10^7$$程度までの方法
  * より大きな値のとき（$$k \leq 10^7, n \leq 10^9$$まで）
* Pが素数でないとき（$$n \leq 5000$$まで）



