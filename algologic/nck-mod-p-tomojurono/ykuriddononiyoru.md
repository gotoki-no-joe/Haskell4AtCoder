# 拡張ユークリッドの互除法による逆元

ほぼ引き写しになってしまうが…

mod P における $$a$$の逆元$$x = a^{-1} \mod P$$ を求めたいとする。  
$$a$$と$$x$$は次の関係にある。  
$$a x = 1 \mod P$$  
mod P で等しいとはつまり（modなしで）次式を満たす何らかの$$y$$ が存在するということ。  
$$ax = 1 - Py$$  
これを移項すると以下のようになる。  
$$ax + Py = 1$$  
$$a$$と $$P$$ が互いに素なら $$\gcd(a,P) = 1$$なので\(\*\)、この式は拡張ユークリッド法の式  
$$ax + by = gcd(a,b)$$  
と一致し、$$b=P$$として解を求めたときの$$x$$が$$a$$の逆元である。

条件\(\*\)について、競技プログラミングでは一般に$$P$$は$$a$$より大きい素数が設定されるので、互いに素となる。  
$$P$$が素数でなくても、$$a$$と互いに素でありさえすればこの方法は適用できる。

```haskell
inv p a = mod (fst $ extend_gcd a p) p
-- 結果が負数でも構わなければ以下でもよい
inv p a = fst $ extend_gcd a p
```

他の方法と異なり、これのみ、mod pをかけないと負の数が返ることがある。

このコードは機能分割が美しいが、「あのどこ」の方のコードは、拡張ユークリッド互除法を自分で再帰せずにiterateで書いているところがいい。一長一短。

